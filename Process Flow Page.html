<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>MicroSiteKit ‚Äì Process Flow Page</title>

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/css/bootstrap.min.css" rel="stylesheet" />

    <!-- Custom Styles -->
    <link href="Assets/css/style.css" rel="stylesheet" />

    <!-- Mermaid Setup -->
    <script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
    <script type="module">
        import mermaid from "https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs";
        mermaid.initialize({ startOnLoad: false });
        window.mermaid = mermaid;
    </script>
</head>

<body class="glass">
    <!-- Injected Partials -->
    <div id="shared-header"></div>
    <div id="main-nav"></div>
    <div id="sidebar-nav"></div>

    <!-- Page-Specific Content -->
    <div class="container">
        <nav aria-label="breadcrumb">
            <ol class="breadcrumb" id="breadcrumb"></ol>
        </nav>
        <div class="row">
            <div class="col-md-4 gradient-col d-flex align-items-center justify-content-center">
                <h3 class="gradient-text">Process Flow Page</h3>
            </div>
            <div class="col-md-8">
                <div class="page-intro text-center py-4 px-3">
                    <p>This page visualises the Reasonable Adjustments Plan (RAP) process using a clear,
                        contributor-first
                        flowchart. It‚Äôs built with <code>mermaid.js</code> and styled for clarity, accessibility, and
                        modular
                        reuse.
                    </p>

                    <ul>
                        <li>üß† Helps contributors understand the RAP journey at a glance</li>
                        <li>üìÑ Uses Mermaid syntax for editable, version-controlled diagrams</li>
                        <li>üé® Theme-safe and layout-friendly‚Äîuses Bootstrap spacing and Mermaid container</li>
                        <li>üß© Easily pairs with toolkit links, onboarding strips, and mascot guidance</li>
                        <li>üõ†Ô∏è Fully editable‚Äîjust update the Mermaid block below</li>
                    </ul>

                    <p>Use this page to support onboarding, clarify responsibilities, or embed in wider wellbeing and
                        inclusion
                        resources.</p>
                </div>
            </div>



            <!-- Page full width content -->
            <div class="row mt-4">
                <div class="col-md">
                    <h5 class="mt-4 mb-2">üó∫Ô∏è RAP Process Flow</h5>

                    <div class="mermaid">
                        flowchart TD

                        %% === ENTRY POINT ===
                        Start["<div class='flow-box'>
                            <h3>üö™ Entry Node</h3>
                            <h5>Contributor enters the Engine. Mascot greets them with a pun and a scroll.</h5>
                        </div>"]:::entry

                        %% === ROLE SPLIT ===
                        Split["<div class='flow-box'>
                            <h3>üß¨ Role Splitter</h3>
                            <h5>Contributor is sorted into one or more roles:</h5>
                            <ul>
                                <li>üß† Architect</li>
                                <li>üé® Designer</li>
                                <li>üõ†Ô∏è Builder</li>
                                <li>üì£ Communicator</li>
                            </ul>
                        </div>"]:::role

                        Architect["<div class='flow-box'>
                            <h3>üß† Architect</h3>
                            <h5>Scaffolds the onboarding space. Defines dohicky zones and mascot habitats.</h5>
                        </div>"]:::role

                        Designer["<div class='flow-box'>
                            <h3>üé® Designer</h3>
                            <h5>Creates visual language, sticker packs, and theme-safe layouts.</h5>
                        </div>"]:::role

                        Builder["<div class='flow-box'>
                            <h3>üõ†Ô∏è Builder</h3>
                            <h5>Codes the dohickies. Comments everything. Makes onboarding joyful.</h5>
                        </div>"]:::role

                        Communicator["<div class='flow-box'>
                            <h3>üì£ Communicator</h3>
                            <h5>Writes lore, guides, and mascot scripts. Translates chaos into clarity.</h5>
                        </div>"]:::role

                        %% === TRIALS ===
                        TrialA["<div class='flow-box'>
                            <h3>üß™ Trial of Modularity</h3>
                            <h5>Refactor a spaghetti snippet into a reusable dohicky.</h5>
                        </div>"]:::trial

                        TrialB["<div class='flow-box'>
                            <h3>üß™ Trial of Empathy</h3>
                            <h5>Explain a tooltip to a confused dragon.</h5>
                        </div>"]:::trial

                        TrialC["<div class='flow-box'>
                            <h3>üß™ Trial of Clarity</h3>
                            <h5>Fix a broken link in a legacy onboarding strip.</h5>
                        </div>"]:::trial

                        %% === CHAOS EVENTS ===
                        Chaos1["<div class='flow-box'>
                            <h3>üî• Chaos Event: Role Redefinition</h3>
                            <h5>Contributor‚Äôs role is reshaped mid-flow. Must advocate for joy and clarity.</h5>
                        </div>"]:::chaos

                        Chaos2["<div class='flow-box'>
                            <h3>üå™Ô∏è Chaos Event: Acronym Storm</h3>
                            <h5>Contributor is bombarded with unexplained abbreviations. Must decode or reroute.</h5>
                        </div>"]:::chaos

                        %% === LOOPS ===
                        Loop1["<div class='flow-box'>
                            <h3>üîÅ Feedback Loop</h3>
                            <h5>Contributor receives feedback, iterates, and re-shares.</h5>
                        </div>"]:::loop

                        Loop2["<div class='flow-box'>
                            <h3>üîÅ Lore Loop</h3>
                            <h5>Contributor discovers ancient onboarding scrolls and updates the microsite mythos.</h5>
                        </div>"]:::lore

                        %% === FUSION ===
                        Fusion["<div class='flow-box'>
                            <h3>üß© Role Fusion</h3>
                            <h5>Contributor merges roles. Becomes a hybrid onboarding guardian.</h5>
                        </div>"]:::fusion

                        %% === FINAL FORM ===
                        Final["<div class='flow-box'>
                            <h3>üåü Final Form</h3>
                            <h5>Contributor achieves onboarding enlightenment. Mascot weeps with pride.</h5>
                        </div>"]:::final

                        %% === FLOW ===
                        Start --> Split
                        Split --> Architect --> TrialA
                        Split --> Designer --> TrialB
                        Split --> Builder --> TrialC
                        Split --> Communicator --> TrialB

                        TrialA --> Loop1 --> Fusion
                        TrialB --> Loop2 --> Fusion
                        TrialC --> Loop1

                        Fusion --> Chaos1 --> Loop2
                        Fusion --> Chaos2 --> Loop1

                        Chaos1 --> Communicator
                        Chaos2 --> Architect

                        Fusion --> Final
                        Final --> Start
                    </div>


                    <!-- Page full width content -->
                    <div class="row mt-4">
                        <div class="col-md">
                            <h5 class="mt-4 mb-2">üß† Contributor Engine Code</h5>
                            <ul>

                                <li><strong>Customise the Mermaid diagram:</strong> Add, remove, or rename nodes inside
                                    the
                                    <code>&lt;div class="mermaid"&gt;</code> block. Use
                                    <code>&lt;div class='flow-box'&gt;</code> for
                                    consistent styling and HTML formatting.
                                    <br><code>&lt;div class="mermaid"&gt;flowchart TD ...&lt;/div&gt;</code>
                                </li>

                                <li><strong>Style it safely:</strong> Use Bootstrap classes like <code>mt-4</code>,
                                    <code>mb-2</code>,
                                    and
                                    <code>col-md</code> to maintain layout harmony. Style <code>.flow-box</code> in your
                                    CSS for visual
                                    joy.
                                </li>

                                <li><strong>Make it modular:</strong> Drop this scaffold into any page. It pairs
                                    beautifully with
                                    headers,
                                    menus, mascot strips, and dohicky dashboards.
                                </li>

                                <li><strong>Optional:</strong> Add a ‚ÄúBack to Toolkit‚Äù button, lore panel, or
                                    collapsible dohicky
                                    below
                                    the
                                    diagram for extra clarity and contributor delight.
                                </li>
                            </ul>

                            <p>This scaffold helps contributors visualise complex onboarding systems with clarity,
                                recursion, and
                                mascot-powered joy‚Äîwhether they‚Äôre navigating role redefinition, building dohickies, or
                                documenting
                                lore.
                            </p>

                            <h5 class="mt-4 mb-2">üîç Mermaid Font Size & Complexity</h5>

                            <p>Mermaid diagrams are brilliant for visualising flows, but they do have a few
                                quirks‚Äîespecially when
                                things
                                get big, bold, and beautifully complex. Here‚Äôs what contributors should know:</p>

                            <ul>
                                <li><strong>üìè Font size may shrink automatically:</strong> Mermaid tries to fit the
                                    entire diagram
                                    into
                                    the
                                    available space. If your chart is large or dense, it may reduce the font size to
                                    avoid overflow.
                                </li>

                                <li><strong>üß† Complexity affects readability:</strong> Charts with lots of nodes,
                                    embedded HTML, or
                                    deep
                                    branching structures are more likely to trigger auto-scaling. Even if you set a
                                    larger font size,
                                    Mermaid
                                    may override it.</li>

                                <li><strong>üß© Break big charts into chunks:</strong> For better readability and
                                    contributor joy,
                                    split
                                    complex flows into smaller Mermaid blocks. You can group them by theme, role, or
                                    phase‚Äîlike ‚ÄúManager
                                    Flow,‚Äù ‚ÄúContributor Journey,‚Äù or ‚ÄúMascot Trials.‚Äù</li>

                                <li><strong>üé® Style your content safely:</strong> Use a custom CSS class like
                                    <code>.flow-box</code>
                                    to
                                    control font size, spacing, and layout inside Mermaid nodes. This gives you more
                                    control than
                                    Mermaid‚Äôs
                                    built-in settings.
                                </li>

                                <li><strong>üîç Zoom with CSS:</strong> You can apply <code>transform: scale(1.2)</code>
                                    to the Mermaid
                                    container to visually enlarge the whole diagram. This is great for accessibility
                                    mode or
                                    presentation
                                    views.</li>
                            </ul>

                            <p>Remember: clarity beats complexity. If your diagram starts feeling like a spaghetti
                                monster, break it
                                into
                                themed chunks and let your mascot guide the way!</p>

                            <pre><code class="snippet language-html">
&lt;!-- ===================================== --&gt;
&lt;!-- ======= Contributor Engine Page ======= --&gt;
&lt;!-- ===================================== --&gt;

&lt;div id=&quot;ContributorEngine&quot; class=&quot;page&quot;&gt;
  &lt;div class=&quot;container&quot;&gt;
    &lt;div class=&quot;row&quot;&gt;
      &lt;div class=&quot;col-md-4 gradient-col d-flex align-items-center justify-content-center text-start&quot;&gt;
        &lt;h3 class=&quot;gradient-text&quot;&gt;Contributor Engine&lt;/h3&gt;
      &lt;/div&gt;

      &lt;div class=&quot;col-md-8&quot;&gt;
        &lt;p&gt;This flowchart visualises a modular onboarding engine powered by joy, recursion, and mascot magic.&lt;/p&gt;
        &lt;ul&gt;
          &lt;li&gt;üß¨ Role-based branching and fusion&lt;/li&gt;
          &lt;li&gt;üåÄ Chaos events and feedback loops&lt;/li&gt;
          &lt;li&gt;üìö Lore discovery and onboarding evolution&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/div&gt;
    &lt;/div&gt;

    &lt;div class=&quot;row mt-4&quot;&gt;
      &lt;div class=&quot;col-md&quot;&gt;
        &lt;h5 class=&quot;mt-4 mb-2&quot;&gt;üß† Contributor Engine Flowchart&lt;/h5&gt;
        &lt;div class=&quot;mermaid&quot;&gt;
flowchart TD
Start[&quot;&lt;div class='flow-box'&gt;&lt;h3&gt;üö™ Entry Node&lt;/h3&gt;&lt;p&gt;Contributor enters the Engine...&lt;/p&gt;&lt;/div&gt;&quot;]
Split[&quot;&lt;div class='flow-box'&gt;&lt;h3&gt;üß¨ Role Splitter&lt;/h3&gt;&lt;ul&gt;&lt;li&gt;Architect&lt;/li&gt;&lt;li&gt;Designer&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;&quot;]
Architect[&quot;&lt;div class='flow-box'&gt;&lt;h3&gt;üß† Architect&lt;/h3&gt;&lt;/div&gt;&quot;]
Designer[&quot;&lt;div class='flow-box'&gt;&lt;h3&gt;üé® Designer&lt;/h3&gt;&lt;/div&gt;&quot;]
TrialA[&quot;&lt;div class='flow-box'&gt;&lt;h3&gt;üß™ Trial of Modularity&lt;/h3&gt;&lt;/div&gt;&quot;]
Loop1[&quot;&lt;div class='flow-box'&gt;&lt;h3&gt;üîÅ Feedback Loop&lt;/h3&gt;&lt;/div&gt;&quot;]
Fusion[&quot;&lt;div class='flow-box'&gt;&lt;h3&gt;üß© Role Fusion&lt;/h3&gt;&lt;/div&gt;&quot;]
Final[&quot;&lt;div class='flow-box'&gt;&lt;h3&gt;üåü Final Form&lt;/h3&gt;&lt;/div&gt;&quot;]

Start --> Split
Split --> Architect --> TrialA --> Loop1 --> Fusion --> Final --> Start
Split --> Designer --> TrialA
        &lt;/div&gt;
      &lt;/div&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/div&gt;
    </code></pre>
                            <button class="btn btn-primary w-100 mb-2" onclick="copyVisibleSnippet()">Copy</button>
                        </div>
                    </div>
                    <div class="row mt-4">
                        <div class="col-md border border-primary rounded p-3">
                            <section class="playground mt-5">
                                <h3>‚û°Ô∏è Simple Flowchart Playground</h3>

                                <div class="mb-3">
                                    <label class="form-label">Direction</label>
                                    <select id="flowDirection" class="form-select">
                                        <option value="TD" selected>Top ‚Üí Down (TD)</option>
                                        <option value="LR">Left ‚Üí Right (LR)</option>
                                        <option value="BT">Bottom ‚Üí Top (BT)</option>
                                        <option value="RL">Right ‚Üí Left (RL)</option>
                                    </select>
                                </div>

                                <h5>Nodes</h5>
                                <div class="row fw-bold mb-1">
                                    <div class="col-md-5">ID</div>
                                    <div class="col-md-5">Label</div>
                                    <div class="col-md-2">Action</div>
                                </div>
                                <div id="nodesForm"></div>
                                <button type="button" id="addNodeBtn" class="btn btn-success mb-3">+ Add Node</button>

                                <h5>Edges</h5>
                                <div class="row fw-bold mb-1">
                                    <div class="col-md-5">From</div>
                                    <div class="col-md-5">To</div>
                                    <div class="col-md-2">Action</div>
                                </div>
                                <div id="edgesForm"></div>
                                <button type="button" id="addEdgeBtn" class="btn btn-success mb-3">+ Add Edge</button>

                                <!-- Generate button always on its own line -->
                                <div class="mb-3">
                                    <div class="dohicky-grid">
                                        <div class="dohicky-item"><button type="button" id="generateBtn"
                                                class="btn btn-primary w-100">Generate Code</button></div>
                                        <div class="dohicky-item"><button type="button" class="btn btn-primary w-100"
                                                onclick="copyCode()">Copy</button></div>
                                        <div class="dohicky-item"><button type="button" class="btn btn-primary w-100"
                                                onclick="exportConfig()">üíæ Save Settings</button></div>
                                        <div class="dohicky-item"> <input type="file" id="configFile" accept=".txt"
                                                style="display:none" /> <button type="button"
                                                class="btn btn-primary w-100"
                                                onclick="document.getElementById('configFile').click()">üìÇ Load
                                                Settings</button>
                                        </div>
                                    </div>
                                </div>

                                <div class="row mt-4">
                                    <div class="col-md-6 border border-primary rounded p-3">
                                        <h5>Generated Code</h5>
                                        <pre><code id="output"></code></pre>

                                    </div>
                                    <div class="col-md-6 border border-primary rounded p-3">
                                        <h5>Live Preview</h5>
                                        <div id="previewArea"></div>
                                    </div>
                                </div>
                            </section>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Footer -->
            <div id="shared-footer"></div>

            <!-- Bootstrap JS -->
            <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/js/bootstrap.bundle.min.js"></script>
            <script src="https://cdn.jsdelivr.net/npm/fuse.js/dist/fuse.min.js"></script>
            <!-- Custom JS -->
            <script src="Assets/js/script.js"></script>
            <script src="Assets/js/templates.js"></script>
            <script>
                document.addEventListener("DOMContentLoaded", () => {
                    const nodesForm = document.getElementById("nodesForm");
                    const edgesForm = document.getElementById("edgesForm");

                    function addNode(defaults = { id: "", label: "", shape: "square" }) {
                        const row = document.createElement("div");
                        row.className = "row g-2 mb-2 node-row";
                        row.innerHTML = `
    <div class="col-md-3">
      <input type="text" class="form-control" name="id" placeholder="Node ID" value="${defaults.id}">
    </div>
    <div class="col-md-6">
      <input type="text" class="form-control" name="label" placeholder="Node label" value="${defaults.label}">
    </div>
    <div class="col-md-3">
      <select class="form-select" name="shape">
        <option value="square"   ${defaults.shape === "square" ? "selected" : ""}>Square</option>
        <option value="rounded"  ${defaults.shape === "rounded" ? "selected" : ""}>Rounded</option>
        <option value="stadium"  ${defaults.shape === "stadium" ? "selected" : ""}>Start/Finish</option>
        <option value="subroutine" ${defaults.shape === "subroutine" ? "selected" : ""}>Subroutine</option>
        <option value="cylinder" ${defaults.shape === "cylinder" ? "selected" : ""}>Cylinder</option>
        <option value="circle"   ${defaults.shape === "circle" ? "selected" : ""}>Circle</option>
        <option value="decision" ${defaults.shape === "decision" ? "selected" : ""}>Decision (diamond)</option>
      </select>
    </div>
  `;
                        nodesForm.appendChild(row);
                    }

                    function addEdge(defaults = { from: "", to: "", label: "" }) {
                        const row = document.createElement("div");
                        row.className = "row g-2 mb-2 edge-row";
                        row.innerHTML = `
    <div class="col-md-5">
      <input type="text" class="form-control" name="from" placeholder="From ID" value="${defaults.from}">
    </div>
    <div class="col-md-5">
      <input type="text" class="form-control" name="to" placeholder="To ID" value="${defaults.to}">
    </div>
    <div class="col-md-2">
      <input type="text" class="form-control" name="label" placeholder="Label (optional)" value="${defaults.label}">
    </div>
  `;
                        edgesForm.appendChild(row);
                    }

                    // Seed: yes/no decision
                    addNode({ id: "Start", label: "üö™ Start", shape: "stadium" });
                    addNode({ id: "Decision", label: "Continue?", shape: "decision" });
                    addNode({ id: "Step1", label: "First Step", shape: "rounded" });
                    addNode({ id: "End", label: "üèÅ End", shape: "stadium" });

                    addEdge({ from: "Start", to: "Decision" });
                    addEdge({ from: "Decision", to: "Step1", label: "Yes" });
                    addEdge({ from: "Decision", to: "End", label: "No" });
                    addEdge({ from: "Step1", to: "End" });

                    document.getElementById("addNodeBtn").onclick = () => addNode();
                    document.getElementById("addEdgeBtn").onclick = () => addEdge();

                    document.getElementById("generateBtn").onclick = () => {
                        const direction = document.getElementById("flowDirection").value;

                        const nodes = [...document.querySelectorAll(".node-row")].map(r => ({
                            id: r.querySelector('[name="id"]').value.trim(),
                            label: r.querySelector('[name="label"]').value.trim(),
                            shape: r.querySelector('[name="shape"]').value
                        }));

                        const edges = [...document.querySelectorAll(".edge-row")].map(r => ({
                            from: r.querySelector('[name="from"]').value.trim(),
                            to: r.querySelector('[name="to"]').value.trim(),
                            label: r.querySelector('[name="label"]').value.trim()
                        }));

                        const code = templates.simpleFlowchart({ direction, nodes, edges });
                        document.getElementById("output").textContent = code;
                        document.getElementById("previewArea").innerHTML = code;
                        if (window.mermaid) mermaid.init(undefined, document.querySelectorAll(".mermaid"));
                    };
                });

                function sanitizeSmartCharacters(str) {
                    return str
                        .replace(/[\u2018\u2019\u201A\u201B\u2032\u2035]/g, "'") // single quotes
                        .replace(/[\u201C\u201D\u201E\u201F\u2033\u2036]/g, '"') // double quotes
                        .replace(/[\u2013]/g, '-') // en dash
                        .replace(/[\u2014]/g, '--') // em dash
                        .replace(/\u00A0/g, ' ') // non-breaking space
                        .replace(/\u2026/g, '...') // ellipsis
                        .replace(/\u200B/g, '') // zero-width space
                        .replace(/\uFEFF/g, ''); // BOM
                }

                function copyCode() {
                    const rawText = document.getElementById("output").textContent;
                    const cleanText = sanitizeSmartCharacters(rawText);
                    navigator.clipboard.writeText(cleanText);
                    alert("Code copied (smart characters cleaned)!");
                }
            </script>
</body>

</html>