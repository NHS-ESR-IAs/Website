<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>MicroSiteKit â€“ Countdown Playground</title>

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/css/bootstrap.min.css" rel="stylesheet" />
    <link href="Assets/css/style.css" rel="stylesheet" />
</head>

<body class="glass">
    <!-- Injected Partials -->
    <div id="shared-header"></div>
    <div id="main-nav"></div>
    <div id="sidebar-nav"></div>

    <!-- Page Content -->
    <div class="container">
        <nav aria-label="breadcrumb">
            <ol class="breadcrumb" id="breadcrumb"></ol>
        </nav>
        <div class="row">
            <!-- Sidebar Gradient Title -->
            <div class="col-md-4 gradient-col d-flex align-items-center justify-content-center text-start">
                <h3 class="gradient-text">Countdowns</h3>
            </div>

            <!-- Intro Text -->
            <div class="col-md-8">
                <h4>ğŸ„ Countdown Playground</h4>
                <p>Countdowns are joyful timers that build anticipation for the big dayâ€”whether itâ€™s pay day, launch
                    day, or mince pie day. Theyâ€™re animated, accessible, and fully remixable.</p>
                <ul>
                    <li>â³ Live countdown to any date</li>
                    <li>â„ï¸ Optional snowflake animation</li>
                    <li>ğŸ¨ Custom message, emojis, and styles</li>
                </ul>
                <p>Use them to spark excitement, mark milestones, or sprinkle a little seasonal magic into your
                    microsite.</p>
            </div>
        </div>

        <!-- Playground Panel -->
        <div class="row mt-4">
            <div class="col-md border border-primary rounded p-3">
                <section class="playground mt-5">
                    <h3>ğŸ”§ Playground</h3>

                    <form id="playgroundForm" class="mb-3 row g-3">
                        <!-- Fields will be injected here by renderPlayground -->
                    </form>

                    <div class="dohicky-grid">
                        <div class="dohicky-item"><button type="button" id="generateBtn"
                                class="btn btn-primary w-100">Generate Code</button></div>
                        <div class="dohicky-item"><button type="button" class="btn btn-primary w-100"
                                onclick="copyCode()">Copy</button></div>
                        <div class="dohicky-item"><button type="button" class="btn btn-primary w-100"
                                onclick="exportConfig()">ğŸ’¾ Save Settings</button></div>
                        <div class="dohicky-item">
                            <input type="file" id="configFile" accept=".txt" style="display:none" />
                            <button type="button" class="btn btn-primary w-100"
                                onclick="document.getElementById('configFile').click()">ğŸ“‚ Load Settings</button>
                        </div>
                    </div>

                    <div class="row mt-4">
                        <div class="col-md-6 border border-primary rounded p-3">
                            <h5>Generated Code</h5>
                            <pre><code id="output"></code></pre>
                        </div>
                        <div class="col-md-6 border border-primary rounded p-3">
                            <h5>Live Preview</h5>
                            <div id="previewArea"></div>
                        </div>
                    </div>
                </section>
            </div>
        </div>

        <!-- Snippet Guide -->
        <div class="row mt-5">
            <div class="col-md">
                <h5 class="mt-4 mb-2">ğŸ§© Snippet Guide: Countdown with Cheer</h5>
                <ul>
                    <li><strong>Set your date</strong> to any future milestoneâ€”pay day, launch day, or even biscuit
                        oâ€™clock.</li>
                    <li><strong>Customize the message</strong> that appears when the countdown hits zero.</li>
                    <li><strong>Sprinkle emojis</strong> for festive flair or team in-jokes.</li>
                    <li><strong>Adjust snowflakes</strong> for a gentle flurry or full-on blizzard.</li>
                    <li><strong>Copy or save</strong> your config to reuse across pages or share with your team.</li>
                </ul>
            </div>
        </div>

        <!-- Footer -->
        <div id="shared-footer"></div>

        <!-- Bootstrap JS + Playground Scripts -->
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/js/bootstrap.bundle.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/fuse.js/dist/fuse.min.js"></script>
        <script src="Assets/js/script.js"></script>
        <script src="Assets/js/templates.js"></script>
        <script src="Assets/js/countdown-playground.js"></script>

        <script>
            document.addEventListener("DOMContentLoaded", () => {
                const config = {
                    fields: [
                        {
                            id: "countdownId",
                            label: "Countdown ID",
                            type: "text",
                            default: "christmasCountdown"
                        },
                        {
                            id: "title",
                            label: "Countdown Title",
                            type: "text",
                            default: "ğŸ… Countdown to Christmas Pay Day ğŸ"
                        },
                        {
                            id: "payday",
                            label: "Pay Day Date",
                            type: "date",
                            default: "2025-12-22"
                        },
                        {
                            id: "message",
                            label: "Pay Day Message",
                            type: "text",
                            default: "ğŸ’· It's Pay Day! Merry Christmas!"
                        },
                        {
                            id: "emojiRow",
                            label: "Emoji Row",
                            type: "text",
                            default: "ğŸ’· ğŸ„ â„ï¸ â›„ ğŸ”” ğŸŒŸ ğŸª ğŸ•¯ï¸"
                        },
                        {
                            id: "snowflakes",
                            label: "Number of Snowflakes",
                            type: "range",
                            min: 5,
                            max: 40,
                            step: 1,
                            default: 20
                        }
                    ],
                    template: "countdown"
                };

                renderPlayground(config);
            });

            function sanitizeSmartCharacters(str) {
                return str
                    .replace(/[\u2018\u2019\u201A\u201B\u2032\u2035]/g, "'")
                    .replace(/[\u201C\u201D\u201E\u201F\u2033\u2036]/g, '"')
                    .replace(/[\u2013]/g, '-')
                    .replace(/[\u2014]/g, '--')
                    .replace(/\u00A0/g, ' ')
                    .replace(/\u2026/g, '...')
                    .replace(/\u200B/g, '')
                    .replace(/\uFEFF/g, '');
            }

            function copyCode() {
                const rawText = document.getElementById("output").textContent;
                const cleanText = sanitizeSmartCharacters(rawText);
                navigator.clipboard.writeText(cleanText);
                alert("Code copied (smart characters cleaned)!");
            }
        </script>
    </div>
</body>

</html>